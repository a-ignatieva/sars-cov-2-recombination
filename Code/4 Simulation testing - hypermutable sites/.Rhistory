P <- read.table("mut_map_adjusted_p_50f_2.txt")
position <- 1:29903
position <-  positions[!(position %in% mask)]
mut_probs <- cbind(P, position)
P <- read.table("mut_map_adjusted_p_50f_2.txt")
position <- 1:29903
position <-  position[!(position %in% mask)]
mut_probs <- cbind(P, position)
position <- 1:29903
position <-  position[-mask]
vcf <- fread("../problematic_sites_sarsCov2.vcf", check.names=TRUE, skip="#CHROM")
# From Van Dorp
homoplasic <- c(11083,13402,21575,16887,27384,3037,25563,8782,10323,11074,14408,6255,12880,21137,1059,1820,1912,6040,15324,29353,14805,15720,18060,28077,28826,28887,29253,29553,29700,6310,6312,11704,14786,17747,18756,20148,22661,23010,23403,29095,29422,3177,4084,6990,8078,11916,14724,14925,17247,18788,18877,20755,21648,24034,25947,26152,26461,27005,27046,27964,28881,29742,1457,4255,5784,7011,8293,8917,9223,10319,10507,11320,12781,13947,15760,16260,19684,22988,23422,24390,25916,26144,26530,26730,27525,28144,28311,28344,28851,28854,29751,379,541,833,884,1076,1570,1594,2113,3096,3253,3787,4113,4320,6573,7438,7765,10789,10851,11417,14747,15960,16762,17410,17639,17799,17858,18656,20031,20268,20275,21204,21707,23533,23587,24368,24389,24694,25494,25688,26211,26729,26735,28657,28688,28739,28857,28878,29540,29585,29734,313,490,1515,2455,2558,4809,6723,7479,8767,9477,9479,10097,10265,10450,11195,11801,13730,13929,14741,14912,15277,15927,16289,16381,17104,17373,17690,17944,18652,18713,18928,18998,19170,20931,23086,23707,23731,23929,24054,24862,25433,25572,25979,26124,26625,26936,27299,27635,27679,28580,28821,28836,28882,28883,29144,29635,29686)
mask <- c(vcf$POS, homoplasic)
mask <- unique(mask)
library(tidyverse)
library(reshape2)
library(stringr)
library(RColorBrewer)
library(latex2exp)
library(data.table)
library(smooth)
library(zoo)
library(R.utils)
vcf <- fread("../problematic_sites_sarsCov2.vcf", check.names=TRUE, skip="#CHROM")
# From Van Dorp
homoplasic <- c(11083,13402,21575,16887,27384,3037,25563,8782,10323,11074,14408,6255,12880,21137,1059,1820,1912,6040,15324,29353,14805,15720,18060,28077,28826,28887,29253,29553,29700,6310,6312,11704,14786,17747,18756,20148,22661,23010,23403,29095,29422,3177,4084,6990,8078,11916,14724,14925,17247,18788,18877,20755,21648,24034,25947,26152,26461,27005,27046,27964,28881,29742,1457,4255,5784,7011,8293,8917,9223,10319,10507,11320,12781,13947,15760,16260,19684,22988,23422,24390,25916,26144,26530,26730,27525,28144,28311,28344,28851,28854,29751,379,541,833,884,1076,1570,1594,2113,3096,3253,3787,4113,4320,6573,7438,7765,10789,10851,11417,14747,15960,16762,17410,17639,17799,17858,18656,20031,20268,20275,21204,21707,23533,23587,24368,24389,24694,25494,25688,26211,26729,26735,28657,28688,28739,28857,28878,29540,29585,29734,313,490,1515,2455,2558,4809,6723,7479,8767,9477,9479,10097,10265,10450,11195,11801,13730,13929,14741,14912,15277,15927,16289,16381,17104,17373,17690,17944,18652,18713,18928,18998,19170,20931,23086,23707,23731,23929,24054,24862,25433,25572,25979,26124,26625,26936,27299,27635,27679,28580,28821,28836,28882,28883,29144,29635,29686)
mask <- c(vcf$POS, homoplasic)
mask <- unique(mask)
setwd("~/Dropbox/beagle/data_folders/covid_paper_work/notebooks/for_github/Code/4 Simulation testing - hypermutable sites")
# Mask problematic sites
vcf <- fread("problematic_sites_sarsCov2.vcf", check.names=TRUE, skip="#CHROM")
# From Van Dorp
homoplasic <- c(11083,13402,21575,16887,27384,3037,25563,8782,10323,11074,14408,6255,12880,21137,1059,1820,1912,6040,15324,29353,14805,15720,18060,28077,28826,28887,29253,29553,29700,6310,6312,11704,14786,17747,18756,20148,22661,23010,23403,29095,29422,3177,4084,6990,8078,11916,14724,14925,17247,18788,18877,20755,21648,24034,25947,26152,26461,27005,27046,27964,28881,29742,1457,4255,5784,7011,8293,8917,9223,10319,10507,11320,12781,13947,15760,16260,19684,22988,23422,24390,25916,26144,26530,26730,27525,28144,28311,28344,28851,28854,29751,379,541,833,884,1076,1570,1594,2113,3096,3253,3787,4113,4320,6573,7438,7765,10789,10851,11417,14747,15960,16762,17410,17639,17799,17858,18656,20031,20268,20275,21204,21707,23533,23587,24368,24389,24694,25494,25688,26211,26729,26735,28657,28688,28739,28857,28878,29540,29585,29734,313,490,1515,2455,2558,4809,6723,7479,8767,9477,9479,10097,10265,10450,11195,11801,13730,13929,14741,14912,15277,15927,16289,16381,17104,17373,17690,17944,18652,18713,18928,18998,19170,20931,23086,23707,23731,23929,24054,24862,25433,25572,25979,26124,26625,26936,27299,27635,27679,28580,28821,28836,28882,28883,29144,29635,29686)
mask <- c(vcf$POS, homoplasic)
mask <- unique(mask)
P <- read.table("mut_map_adjusted_p_50f_2.txt")
position <- 1:29903
position <-  position[-mask]
mut_probs <- cbind(P, position)
ggplot(data=mut_probs, aes(x=position, y=V1)) +
geom_line(size=1) +
theme_minimal() +
xlab("Position") +
ylab(TeX("$\\widetilde{P}_{50,2}$")) +
scale_x_continuous(breaks = seq(0,30000,5000), labels = seq(0,30000,5000), minor_breaks=seq(0,30000,1000)) +
scale_y_continuous(breaks = seq(-0.00001,0.00014, 0.00002), labels = seq(-0.00001,0.00014, 0.00002), minor_breaks=NULL)
ggplot(data=mut_probs, aes(x=position, y=V1)) +
geom_point(size=1) +
theme_minimal() +
xlab("Position") +
ylab(TeX("$\\widetilde{P}_{50,2}$")) +
scale_x_continuous(breaks = seq(0,30000,5000), labels = seq(0,30000,5000), minor_breaks=seq(0,30000,1000)) +
scale_y_continuous(breaks = seq(-0.00001,0.00014, 0.00002), labels = seq(-0.00001,0.00014, 0.00002), minor_breaks=NULL)
